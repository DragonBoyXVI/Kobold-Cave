[gd_scene load_steps=20 format=3 uid="uid://cdnubucseh6ix"]

[ext_resource type="PackedScene" uid="uid://b0y3e3k6tk6xw" path="res://Kobold Cave/Entity/entity_base.tscn" id="1_2j47d"]
[ext_resource type="Script" uid="uid://dt6t6t4lcx3tb" path="res://Kobold Cave/Entity/Wolf/wolf.gd" id="2_c5c4t"]
[ext_resource type="PackedScene" uid="uid://c2sv5wtxoty01" path="res://Kobold Cave/Entity/Player/player_model.tscn" id="3_6feir"]
[ext_resource type="Resource" uid="uid://q6gst07iemw5" path="res://Kobold Cave/Entity/Wolf/movement.tres" id="3_8plix"]
[ext_resource type="PackedScene" uid="uid://c8x5xrtyya5nj" path="res://Dragon Game Template/Components/Multi/Node Health/node_health.tscn" id="4_sg76n"]
[ext_resource type="Script" uid="uid://bp718wotfrc6m" path="res://Dragon Game Template/Resources/Health/health.gd" id="5_arsdn"]
[ext_resource type="PackedScene" uid="uid://dlqiqpp6c50k6" path="res://Dragon Game Template/Components/2D/Hitbox 2D/hitbox_2d.tscn" id="6_5fft6"]
[ext_resource type="Resource" uid="uid://dtqt8suvkv3jo" path="res://Kobold Cave/Saved Resources/Hitbox masks/enemy_mask.tres" id="7_cgkj6"]
[ext_resource type="PackedScene" uid="uid://cksnwnxdury7g" path="res://Dragon Game Template/Components/Multi/State/Behaviour/State Machine/state_machine.tscn" id="8_x7y00"]
[ext_resource type="Script" uid="uid://bad3padtw4h4x" path="res://Kobold Cave/Entity/Wolf/States/march_foreward.gd" id="10_d2b60"]
[ext_resource type="Script" uid="uid://byqxxd23k7oda" path="res://Kobold Cave/Entity/Wolf/States/idle.gd" id="11_6x55g"]
[ext_resource type="Script" uid="uid://wbv0erih5ley" path="res://Kobold Cave/Entity/Wolf/States/airborne.gd" id="12_oyrkr"]
[ext_resource type="PackedScene" uid="uid://dnq4sc0morxxn" path="res://Dragon Game Template/Components/2D/Hurtbox 2D/hurtbox_2d.tscn" id="13_q6r7d"]
[ext_resource type="Script" uid="uid://c5gadi8o0xx0i" path="res://Dragon Game Template/Resources/Hurtbox Event/Damage/damage_base.gd" id="14_j1f21"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_k13x5"]
size = Vector2(120, 68)

[sub_resource type="Resource" id="Resource_hhi7x"]
resource_local_to_scene = true
script = ExtResource("5_arsdn")
ignore_max = true
maximum = 2
current = 2
percent = 1.0
element_heal_flag = 4

[sub_resource type="CircleShape2D" id="CircleShape2D_hgrgg"]
radius = 56.0

[sub_resource type="Resource" id="Resource_bs8k3"]
script = ExtResource("14_j1f21")
amount = 1
peirce = 0
element = 5

[sub_resource type="CircleShape2D" id="CircleShape2D_qkqiw"]
radius = 48.0

[node name="Wolf" node_paths=PackedStringArray("model", "health_node", "hitbox", "state_machine") instance=ExtResource("1_2j47d")]
script = ExtResource("2_c5c4t")
movement_stats = ExtResource("3_8plix")
model = NodePath("FlipPivot/PlayerModel")
health_node = NodePath("NodeHealth")
hitbox = NodePath("Hitbox2D")
state_machine = NodePath("StateMachine")
metadata/_edit_group_ = true

[node name="FlipPivot" type="Node2D" parent="." index="0"]
unique_name_in_owner = true

[node name="PlayerModel" parent="FlipPivot" index="0" instance=ExtResource("3_6feir")]
modulate = Color(1, 0, 0, 1)

[node name="RayFloor" type="RayCast2D" parent="FlipPivot" index="1"]
position = Vector2(60, 0)

[node name="RayWall" type="RayCast2D" parent="FlipPivot" index="2"]
position = Vector2(60, -32)
target_position = Vector2(50, 0)

[node name="CollisionShape2D" type="CollisionShape2D" parent="." index="1"]
position = Vector2(0, -34)
shape = SubResource("RectangleShape2D_k13x5")

[node name="NodeHealth" parent="." index="2" instance=ExtResource("4_sg76n")]
health = SubResource("Resource_hhi7x")

[node name="Hitbox2D" parent="." index="3" node_paths=PackedStringArray("event_recivers") instance=ExtResource("6_5fft6")]
position = Vector2(0, -34)
event_recivers = [NodePath("../NodeHealth")]
team_mask = ExtResource("7_cgkj6")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Hitbox2D" index="0"]
shape = SubResource("CircleShape2D_hgrgg")
debug_color = Color(0, 0, 1, 0.4)

[node name="StateMachine" parent="." index="4" node_paths=PackedStringArray("initial_state") instance=ExtResource("8_x7y00")]
initial_state = NodePath("Idle")
default_enter_args = Dictionary[StringName, Variant]({})

[node name="MarchForeward" type="Node" parent="StateMachine" index="0" node_paths=PackedStringArray("wolf", "pivot", "ray_floor", "ray_wall")]
script = ExtResource("10_d2b60")
wolf = NodePath("../..")
pivot = NodePath("../../FlipPivot")
ray_floor = NodePath("../../FlipPivot/RayFloor")
ray_wall = NodePath("../../FlipPivot/RayWall")

[node name="Idle" type="Node" parent="StateMachine" index="1" node_paths=PackedStringArray("wolf", "wait_timer")]
script = ExtResource("11_6x55g")
wolf = NodePath("../..")
wait_timer = NodePath("Timer")
default_enter_args = Dictionary[StringName, Variant]({
&"Flip on Leave": true
})

[node name="Timer" type="Timer" parent="StateMachine/Idle" index="0"]
process_callback = 0
wait_time = 1.25
one_shot = true

[node name="Airborne" type="Node" parent="StateMachine" index="2" node_paths=PackedStringArray("wolf")]
script = ExtResource("12_oyrkr")
wolf = NodePath("../..")

[node name="Hurtbox2D" parent="." index="5" node_paths=PackedStringArray("exclude") instance=ExtResource("13_q6r7d")]
position = Vector2(0, -32)
exclude = [NodePath("../Hitbox2D")]
team_mask = ExtResource("7_cgkj6")
event = SubResource("Resource_bs8k3")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Hurtbox2D" index="0"]
shape = SubResource("CircleShape2D_qkqiw")
debug_color = Color(1, 0, 0, 0.4)
